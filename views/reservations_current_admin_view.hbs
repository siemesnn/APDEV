{{!-- this is currentreservations.ejs ver--}}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/sidebar-admin.css">
    <link rel="stylesheet" href="css/colors.css">
    
    <script src="js/view_reservation_page.js"></script>
    <title>{{title}}</title>
</head>
<aside class="sidebar-admin">
    <div class="image-container">
      <img src="assets/jeongwoo.jpg" alt="userpfp" id="userpfp">
      <br>
      <br>
    </div>
  
    <ul class="sidebar-links">
      <li>
        <br><br>
        <a href="/home">Reserve</a>
      </li>
      <li>
        <br><br>
        <a href="/reserve">View Reservations</a>
      </li>
      <li>
        <br><br>
        <a href="/profile" id="profile">My Profile</a>
      </li>
      <li>
        <br><br><br>
        <a href="/logout" id="logout">Logout</a>
      </li>
    </ul>
</aside>

<link rel="stylesheet" href="css/myreservation.css">

<div class="notSidebar">

    <div class="greeting-profile">
        <h2> Reservations </h2>
    </div>

    <div class="table-container">
        <table class="reservations-table">
            <thead>
                <tr>
                    <th>Lab</th>
                    <th>Seat</th>
                    <th>Date</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Reservation Name</th>
                </tr>
            </thead>
            <tbody>
                {{#each Reservation}}
                        <tr>
                            <td>{{#if lab_id}}{{ lab_id }}{{else}}N/A{{/if}}</td>
                            <td>{{#if seatNumber}}{{ seatNumber }}{{else}}N/A{{/if}}</td>
                            <td>{{#if date}}{{ date }}{{else}}N/A{{/if}}</td>
                            <td>{{#if start_time}}{{ start_time }}{{else}}N/A{{/if}}</td>
                            <!-- Calculate End Time based on Start Time and Duration -->
                            <td>{{#if end_time}}{{ end_time }}{{else}}N/A{{/if}}</td>
                            <td>                                
                                {{#if reserved_by}}
                                    <a href="/viewprofile?username={{ reserved_by }}">{{ reserved_by }}</a>                                
                                {{else}}
                                    {{ reserveFor }}
                                {{/if}}
                            </td>
                        </tr>
                    {{/each}}
            </tbody>
        </table>
    </div>

    <div class="button-container">
        <button onclick="navigateTo('reservation.ejs')" class="button" id="editReservationButton">Edit Reservation</button>
        <button class="button" id="cancelReservationButton">Cancel Reservation</button>
    </div>

</div>

<script>
   document.addEventListener("DOMContentLoaded", function() {
    const table = document.querySelector(".reservations-table");
    
    if (table) {
        const rows = table.querySelectorAll("tbody tr");
        
        if (rows.length > 0) {
            rows.forEach(row => {
                row.addEventListener("click", function() {
                    console.log("Row clicked:", row);
                    
                    // Remove 'selected' class from all rows
                    rows.forEach(r => {
                        r.classList.remove("selected");
                    });
                    
                    // Add 'selected' class to the clicked row
                    row.classList.add("selected");
                    
                    // Print out the contents of the selected row
                    const rowData = Array.from(row.children).map(cell => cell.textContent);
                    console.log("Selected row contents:", rowData);
                });
            });
        } else {
            console.log("No rows found in the table.");
        }
    } else {
        console.log("Table not found.");
    }
});



</script>

</html>
